{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <!-- 검색 필터 -->
    <div class="row mb-4">
        <div class="col-12">
            <form method="GET" action="{% url 'search:search' %}" class="search-form">
                <!-- 검색어 입력 -->
                <div class="input-group mb-3">
                    <input type="text" name="q" class="form-control" value="{{ query }}" placeholder="검색어를 입력하세요">
                    <button class="btn btn-primary" type="submit">검색</button>
                </div>
                
                <!-- 필터 옵션들 -->
                <div class="row g-3">
                    <!-- 카테고리 필터 -->
                    <div class="col-md-4">
                        <label class="form-label">카테고리</label>
                        <select name="type" class="form-select" multiple>
                            {% for category in categories %}
                            <option value="{{ category.content_type }}" 
                                {% if category.content_type in selected_types %}selected{% endif %}>
                                {{ category.name }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <!-- 지역 필터 -->
                    <div class="col-md-4">
                        <label class="form-label">지역</label>
                        <select name="area" class="form-select">
                            <option value="">전체</option>
                            {% for area_item in areas %}
                            <option value="{{ area_item.code }}"
                                {% if area_item.code == selected_area %}selected{% endif %}>
                                {{ area_item.name }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <!-- 정렬 옵션 -->
                    <div class="col-md-4">
                        <label class="form-label">정렬</label>
                        <select name="sort" class="form-select">
                            <option value="latest" {% if sort == 'latest' %}selected{% endif %}>최신순</option>
                            <option value="popular" {% if sort == 'popular' %}selected{% endif %}>인기순</option>
                        </select>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- 검색 결과 -->
    <div class="row">
        {% if places %}
            {% for place in places %}
            <div class="col-md-3 mb-4">
                <div class="card h-100">
                    <img src="{{ place.thumb_img|default:place.image|default:'/static/images/no-image.jpg' }}" 
                         class="card-img-top" alt="{{ place.title }}">
                    <div class="card-body">
                        <h5 class="card-title">{{ place.title }}</h5>
                        <p class="card-text">{{ place.overview|truncatechars:100 }}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">{{ place.category.name }}</small>
                            <small class="text-muted">{{ place.sigungu_code.area_code.name }}</small>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="col-12 text-center">
                <p>검색 결과가 없습니다.</p>
            </div>
        {% endif %}
    </div>
</div>

<!-- 검색 페이지 전용 스타일 -->
<style>
.search-form {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.card {
    transition: transform 0.2s;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.card:hover {
    transform: translateY(-5px);
}

.card-img-top {
    height: 200px;
    object-fit: cover;
}
</style>
{% endblock %}
